<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>An introduction to the DamageScanner | Infrastructure Risk &amp; Resilience Group</title> <meta name="author" content=" Infrastructure Risk &amp; Resilience Group"> <meta name="description" content="A blog post on how to use and apply it."> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.png"> <link rel="shortcut icon" href="/assets/img//assets/img/favicon.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://infrastructure-risk.eu/blog/2015/code/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Infrastructure Risk &amp; Resilience Group</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home</a> </li> <li class="nav-item "> <a class="nav-link" href="/team">Team</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Code &amp; Data</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">An introduction to the DamageScanner</h1> <p class="post-meta">July 15, 2015</p> <p class="post-tags"> <a href="/blog/2015"> <i class="fas fa-calendar fa-sm"></i> 2015 </a>   ·   <a href="/blog/tag/code"> <i class="fas fa-hashtag fa-sm"></i> code</a>   <a href="/blog/tag/github"> <i class="fas fa-hashtag fa-sm"></i> github</a>     ·   <a href="/blog/category/code-data"> <i class="fas fa-tag fa-sm"></i> code-data</a>   </p> </header> <article class="post-content"> <p>A python toolkit for direct damage assessments for natural hazards. Even though the method is initially developed for flood damage assessments, it can calculate damages for any hazard for which you just require a vulnerability curve (i.e. a one-dimensional relation).</p> <h2 id="background">Background</h2> <p>This package is (loosely) based on the original DamageScanner, which calculated potential flood damages based on inundation depth and land use using depth-damage curves in the Netherlands. The DamageScanner was originally developed for the ‘Netherlands Later’ project <a href="https://www.rivm.nl/bibliotheek/digitaaldepot/WL_rapport_Overstromingsrisicos_Nederland.pdf" rel="external nofollow noopener" target="_blank">(Klijn et al., 2007)</a>. The original land-use classes were based on the Land-Use Scanner in order to evaluate the effect of future land-use change on flood damages.</p> <h2 id="creating-a-testing-environment">Creating a testing environment</h2> <p>Recommended option is to use a <a href="https://conda.io/miniconda.html" rel="external nofollow noopener" target="_blank">miniconda</a> environment to work in for this project, relying on conda to handle some of the trickier library dependencies.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># Add conda-forge channel for extra packages</span>
conda config <span class="nt">--add</span> channels conda-forge

<span class="c"># Create a conda environment for the project and install packages</span>
conda <span class="nb">env </span>create <span class="nt">-f</span> environment.yml
activate ds_env

</code></pre></div></div> <h2 id="installation">Installation</h2> <p><a href="https://pypi.python.org/project/damagescanner/" rel="external nofollow noopener" target="_blank"><img src="https://img.shields.io/pypi/v/damagescanner.svg?colorB=blue" alt="workflow pypi badge"></a></p> <p><strong>Requirements:</strong> <a href="http://www.numpy.org/" rel="external nofollow noopener" target="_blank">NumPy</a>, <a href="https://pandas.pydata.org/" rel="external nofollow noopener" target="_blank">pandas</a>, <a href="http://geopandas.org/" rel="external nofollow noopener" target="_blank">geopandas</a>, <a href="https://matplotlib.org/" rel="external nofollow noopener" target="_blank">matplotlib</a>, <a href="https://github.com/mapbox/rasterio" rel="external nofollow noopener" target="_blank">rasterio</a>, <a href="https://github.com/tqdm/tqdm" rel="external nofollow noopener" target="_blank">tqdm</a>, <a href="https://docs.xarray.dev/en/stable/" rel="external nofollow noopener" target="_blank">xarray</a>, <a href="https://pyproj4.github.io/pyproj/stable/" rel="external nofollow noopener" target="_blank">pyproj</a></p> <ol> <li>Open the python environment in your command prompt or bash in which you want to install this package.</li> <li>Type <code class="language-plaintext highlighter-rouge">pip install damagescanner</code> and it should install itself into your python environment.</li> <li>Now you can import the package like any other package!</li> </ol> <p>OR:</p> <ol> <li>Clone the repository or download the package on your computer and extract the folder.</li> <li>Go to the DamageScanner folder in your command prompt or bash.</li> <li>Type <code class="language-plaintext highlighter-rouge">python setup.py install</code> and it should install itself into your python environment.</li> <li>Now you can import the package like any other package!</li> </ol> <h2 id="documentation">Documentation</h2> <p>Please refer to the <a href="http://damagescanner.readthedocs.io/" rel="external nofollow noopener" target="_blank">ReadTheDocs</a> of this project for the full documentation of all functions. <br></p> <h2 id="running-a-raster-based-approach">Running a raster-based approach</h2> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td> <td class="code"><pre>    <span class="kn">import</span> <span class="n">os</span>
    
    <span class="c1"># import the RasterScanner
</span>    <span class="kn">from</span> <span class="n">damagescanner.core</span> <span class="kn">import</span> <span class="n">RasterScanner</span>
    
    <span class="c1"># set paths to the data
</span>    <span class="n">inun_map</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">inundation</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">inundation_map.tif</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">landuse_map</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">landuse</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">landuse_map.tif</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">curve_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">curves</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">curves.csv</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">maxdam_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">curves</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">maxdam.csv</span><span class="sh">'</span><span class="p">)</span>
        
    <span class="c1"># run the RasterScanner and return a pandas DataFrame with loss per land-use class
</span>    <span class="n">loss_df</span> <span class="o">=</span> <span class="nc">RasterScanner</span><span class="p">(</span><span class="n">landuse_map</span><span class="p">,</span><span class="n">inun_map</span><span class="p">,</span><span class="n">curve_path</span><span class="p">,</span><span class="n">maxdam_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p><br></p> <h2 id="running-a-vector-based-approach">Running a vector-based approach</h2> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td> <td class="code"><pre>    <span class="c1"># import necessary packages
</span>    <span class="kn">import</span> <span class="n">os</span>
    <span class="kn">import</span> <span class="n">numpy</span>
    <span class="kn">import</span> <span class="n">pandas</span> 
       
    <span class="c1"># import the RasterScanner
</span>    <span class="kn">from</span> <span class="n">damagescanner.core</span> <span class="kn">import</span> <span class="n">VectorScanner</span>
    
    <span class="c1"># set paths to the data
</span>    <span class="n">inun_map</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">inundation</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">inundation_map.tif</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">landuse_map</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">landuse</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">landuse.shp</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># Create maximum damage dictionary
</span>    <span class="n">maxdam</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">grass</span><span class="sh">"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">forest</span><span class="sh">"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">orchard</span><span class="sh">"</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">residential</span><span class="sh">"</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">industrial</span><span class="sh">"</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">retail</span><span class="sh">"</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">farmland</span><span class="sh">"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">cemetery</span><span class="sh">"</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">construction</span><span class="sh">"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">meadow</span><span class="sh">"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">farmyard</span><span class="sh">"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">scrub</span><span class="sh">"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">allotments</span><span class="sh">"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">reservoir</span><span class="sh">"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">static_caravan</span><span class="sh">"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">commercial</span><span class="sh">"</span><span class="p">:</span><span class="mi">300</span><span class="p">}</span>
        
    <span class="c1"># Create some dummy curves that will match the land-use classes
</span>    <span class="n">curves</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">150</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  
    
    <span class="n">curves</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">curves</span><span class="p">,</span>
                                <span class="n">numpy</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">curves</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">maxdam</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))),</span>
                               <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">curves</span> <span class="o">=</span> <span class="n">pandas</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span>
    <span class="n">curves</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">+</span><span class="nf">list</span><span class="p">(</span><span class="n">maxdam</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span>
    <span class="n">curves</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>    

    <span class="c1"># run the VectorScanner and return the landuse map with damage values
</span>    <span class="n">loss_df</span> <span class="o">=</span> <span class="nc">VectorScanner</span><span class="p">(</span><span class="n">landuse</span><span class="p">,</span><span class="n">inun_map</span><span class="p">,</span><span class="n">curves</span><span class="p">,</span><span class="n">maxdam</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Infrastructure Risk &amp; Resilience Group. Last updated: February 19, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>